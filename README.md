# Интелигентна система за управление на водоснабдяване

Този проект представлява интелигентна система за управление на водоснабдяването на сграда, която използва два водоизточника: сондаж (кладенец) и водопровод (ВиК). Системата разполага с резервоар за съхранение на вода и автоматично превключва между различни режими на работа, базирани на наличието на вода, налягането във водопровода и потреблението на вода в сградата.

## Цели на проекта

- Ефективно управление на водните ресурси.
- Осигуряване на непрекъснато водоснабдяване на сградата.
- Автоматично превключване между режимите на работа въз основа на данни от сензори.

## Основни компоненти

1. **Резервоар**: Съхранява вода, която може да се използва за захранване на сградата. Пълни се от сондажа или водопровода в зависимост от режима.
2. **Хидрофорна помпа**: Подава вода от различни източници към сградата.
3. **Сондаж (кладенец)**: Подава вода към резервоара или директно към помпата.
4. **Водопровод (ВиК)**: Основен източник на вода, когато резервоарът е празен или има достатъчно налягане във водопровода.

## Сензори

Системата разполага с различни сензори, които следят ключови параметри като нивото на водата в резервоара, налягането във водопровода и консумацията на вода в сградата. Тези сензори осигуряват обратна връзка, която позволява автоматично превключване между режимите на работа за оптимизация на водоснабдяването.

### Списък на сензорите:
- **Сензор за високо ниво в резервоара**: Засича дали резервоарът е пълен (`tank_high_level`).
- **Сензор за ниско ниво в резервоара**: Засича дали нивото на резервоара е под минималното (`tank_low_level`).
- **Сензор за налягане във водопровода**: Засича дали има достатъчно налягане във водопровода (`water_supply_available`).
- **Сензор за консумация в сградата**: Засича активна консумация на вода в сградата (`building_water_consumption`).

## Клапани

Системата разполага с набор от клапани, които контролират потока на водата между източниците, резервоара, помпата и сградата. Тези клапани се управляват автоматично в зависимост от избрания режим на работа.


<img src="diagrams/water-supply.svg" alt="System Architecture" style="width:100%; height:auto;">

### Списък на клапаните:
- **Клапан: Водоснабдяване към резервоара**: Управлява пълненето на резервоара от водопровода (`valve_supply_to_tank`).
- **Клапан: Сондаж към резервоара**: Управлява пълненето на резервоара от сондажа (`valve_spring_to_tank`).
- **Клапан: Помпа към резервоара**: Управлява връщането на вода от помпата към резервоара (`valve_pump_to_tank`).
- **Клапан: Водоснабдяване към помпата**: Управлява подаването на вода от водопровода към помпата (`valve_supply_to_pump`).
- **Клапан: Сондаж към помпата**: Управлява подаването на вода от сондажа директно към помпата (`valve_spring_to_pump`).
- **Клапан: Резервоар към помпата**: Управлява подаването на вода от резервоара към помпата (`valve_tank_to_pump`).
- **Клапан: Помпа към сградата**: Управлява подаването на вода от помпата към сградата (`valve_pump_to_building`).

## Режими на работа

Системата поддържа четири различни режима на работа:

### 1. Ползване на резервоара (MODE_USE_TANK)
- Помпата черпи вода от резервоара и подава към сградата, докато сондажът пълни резервоара на самотек.
  - **Причина за включване**: Нивото на водата в резервоара е над минималното.
  - **Активни клапани**:
    - `valve_spring_to_tank`: Отворен, ако `tank_high_level` е `false`.
    - `valve_tank_to_pump`: Отворен за подаване на вода към помпата.
    - `valve_pump_to_building`: Отворен за подаване на вода към сградата.
  - **Неактивни клапани**:
    - Всички останали.

### 2. Ползване на водопровода (MODE_USE_SUPPLY)
- Вода от водопровода се подава директно към сградата, докато резервоарът се пълни от сондажа.
  - **Причина за включване**: Нивото в резервоара е под минималното, и налягането във водопровода е достатъчно.
  - **Активни клапани**:
    - `valve_spring_to_tank`: Отворен за продължаване на пълненето от сондажа.
    - `valve_supply_to_pump`: Отворен за подаване на вода от водопровода към помпата.
    - `valve_pump_to_building`: Отворен за подаване на вода към сградата.
  - **Неактивни клапани**:
    - Всички останали.

### 3. Смучене и подаване към сградата (MODE_MIXED_SUPPLY)
- Вода се черпи едновременно от водопровода и сондажа при активна консумация в сградата, ако няма достатъчно налягане във водопровода.
  - **Причина за включване**: Нивото в резервоара е ниско, налягането във водопровода е недостатъчно и има активна консумация в сградата.
  - **Активни клапани**:
    - `valve_supply_to_pump`: Отворен за подаване на вода от водопровода.
    - `valve_spring_to_pump`: Отворен за подаване на вода от сондажа.
    - `valve_pump_to_building`: Отворен за подаване на вода към сградата.
  - **Неактивни клапани**:
    - Всички останали.

### 4. Пълнене на резервоара чрез смучене (MODE_FILL_TANK)
- Помпата черпи вода едновременно от водопровода и сондажа и връща водата в резервоара.
  - **Причина за включване**: Нивото в резервоара е под минималното и няма активна консумация в сградата.
  - **Активни клапани**:
    - `valve_supply_to_pump`: Отворен за подаване на вода от водопровода.
    - `valve_spring_to_pump`: Отворен за подаване на вода от сондажа.
    - `valve_pump_to_tank`: Отворен за връщане на вода в резервоара.
  - **Неактивни клапани**:
    - Всички останали.

## Автоматизация

Системата автоматично преминава между режимите в зависимост от състоянието на сензорите. При ниско ниво на резервоара или недостатъчно налягане във водопровода, системата избира най-подходящия режим, за да осигури непрекъснато водоснабдяване на сградата.




